!function(){var e,t=document,i="addEventListener",o="charCodeAt",n="keyCode",r="keydown",f=0;t[i](r,(function(c){f=c[n]=="&&((%'%'BA"[o](f)?f+1:0,!e&&f>9&&(e=3,function(){function f(e){if(N=U[e])N.currentTime=0;else{for(S in N=new Uint8Array(9e3),Y=50,N)B=S>1e3?e>>4&63:e>>10,N[S]=127+(Y*=1-(15&e)/1e4)*(B/2>S/10%B?-1:1);N=U[v]=c(N)}N.play()}function c(e){return N=e.length,new Audio(URL.createObjectURL(new Blob(["RIFF",new Uint32Array([N+36,1163280727,544501094,16,65537,22050,22050,524289,1635017060,N]),e],{type:"audio/wav"})))}function p(e,t,i,n){return u&&!(-4&e)&&!(-4&t)&&F[o](8*(n||u)-8+2*i+(t>>1))&1<<4*(1&t)+e}function a(){for(T=A;u&&s(l,A+1,h,1););for(m=0;K+4>m;m++)for(y=0;j>y;y++)v=m*j+y,m>=K&&(J[v]=p(y,m-K,0,H[0])?H[0]:0),$[v]=p(y-l,m-T,h)?u:p(y-l,m-A,h)?u+8:J[v]||0,(B=O["tis-"+v])&&((B=B.style).background="#"+(1==e&&2>g%4&&w[m]?"fff":D[$[v]%8]),B.opacity=$[v]>7?.2:1);A=T,T=W+'0;text-align:right;font-size:150%">',O["tis-status"].innerHTML="Score"+T+Z+X+"Lines"+T+z+X+"Level"+T+Q+X}function s(e,t,i,o){for(S=0;y=3&S,m=S>>2,16>S;S++)if(p(y,m,i)&&((y+=e)<0||y>=j||(m+=t)<0||m>=K||J[m*j+y]))return;return l=e,A=t,h=i,P=0,o||a(),1}function d(e){delete V[e[n]]}var u,l,A,h,g,w,b,x,C,v,S,y,m,T,L,B,Y,N,O=window,k="removeEventListener",q="keyup",E=Math,M="LSOSLSOSKSNSKSNS",G=["`+,^,+Y),`.,C,^`\\Yq^.1e31H,01.,C,^`\\Yq","T$$T,+)$),Y))<$TTYTl.).1^..D,\\.,<$TTTTT`","GNKNGNKN"+M+"LSNSL@BCESOSESOSCOCOCOCOBNBN?J?J@CGL@@@@"],I=["xtvstqpsxtvs\\`}|x","tqspqqpptqspY`xx",M+M+M+M],U=[],J=[],$=[],j=10,K=22,R=j*K+20,D="08080890dd936f9e809dd090e09c0c9f22".split(9),F=atob("8ABERAAPIiJxACYCcAQiA3QAIgZwASMCZgBmAGYAZgA2AGIEYAMxAnIAYgJwAjICYwBkAjAGMgE"),H=[],Z=0,z=0,Q=1,P=2,V=[],W='<div style="margin:',X="</div>",_=W+'-14pc -10pc;position:fixed;width:20pc;left:50%;top:50%;font:12px Arial;background:rgba(0,0,0,.8);box-shadow:0 0 2pc #000;border-radius:1pc">'+W+'1pc 2pc;color:#888"><b><a href="https://github.com/ttencate/tis" style="color:inherit">Tis</a></b>: Tetris clone in just 4 kB of JavaScript<br><br>Left/right: move | Up/Ctrl/Alt: rotate | Esc: quit<br>Down/space: soft/hard drop | M: music'+X+W+'0 1pc;float:right;color:#eee;font-size:1pc"><div id="tis-status">'+X+"Next"+W+'8px 0;width:4pc">';for(L=W+'0;width:1pc;height:1pc;float:left;box-shadow:-2px -2px 8px rgba(0,0,0,.4) inset,0 0 2px #000 inset" id="tis-',v=220;R>v;v++)4>v%j&&(_+=L+v+'">'+X);for(_+=X+X+W+'0 2pc 2pc;background:#000;width:10pc;height:20pc">',v=0;R>v;v++)J.push(0),v>19&&220>v&&(_+=L+v+'">'+X);for(b in _+=X+X,(T=t.createElement("div")).innerHTML=_,t.body.appendChild(_=T),T=new Uint8Array(881856),G)for(G[b]+=G[b]+I[b],v=0,S=0;S<G[b].length;)for(B=G[b][o](S++)-(2==b?64:32),y=.00499*E.pow(2,(B%24+(2==b?0:27))/12),L=[15,9,9][b],m=0;m<4593*[1,3,2,4][~~(B/24)];)T[v++]=(T[v]||127)+(m++*y%2<1?L:-L),L*=.9999;(G=c(T)).play(),G.loop=1,function t(i){if(e){if((b=(i-C)/1e3||0)>.1&&(b=.1),C=i,2==e){if(g-- >4&&!(g%4)){for(y=0;j>y;)J[g*j/4+y++]=1+~~(7*E.random());a()}}else if(1==e){if(--g<0){for(m in w)for(v=m*j+j-1;v>=0;v--)J[v]=J[v-j];e=3}a()}else{for(L in V){if((37==L||39==L)&&V[L]>=0&&(V[L]-=V[L]?.05:.2,s(l+1-2*(37==L),A,h)),32==L&&!V[L]){for(;s(l,A+1,h););P=9}if((38==L||18==L||17==L)&&(Y=1-2*(17==L),!V[L]))for(v=0;5>v;)if(T=(1==u?"203(C214A,241<!230#8":'219"!23+BC23;"#21)BA')[o]((h+4+(Y-1)/2)%4*5+v++)-32,s(l+Y*((7&T)-2),A+Y*(2-(T>>3)),(h+4+Y)%4)){f(8303);break}V[L]+=b}if((x+=E.max(V[40]?.2:0,b*E.pow(1.23,Q)))>1&&(x=0,s(l,A+1,h)),P>1){for(v in u&&f(31445),J)J[v]=$[v];L=0,w=[];e:for(m=0;K>m;m++){for(y=0;j>y;)if(!J[m*j+y++])continue e;w[m]=e=1,L++,g=6}if(L&&f([,8392,8260,8242,8225][L]),Z+=100*[0,1,3,5,8][L]*Q,Q=1+~~((z+=L)/10),H.length<2)for(T=1;255!=T;){for(S=0;T&1<<S;S=1+~~(7*E.random()));T|=1<<S,H.push(S)}u=H.shift(),x=0,s(3,0,0)||(u=0,e=2,g=4*K,f(31360))}P+=b}requestAnimationFrame(t)}}(0),t[i](r,(function i(o){77==(T=o[n])&&G[G.paused?"play":"pause"](),27==T&&(t.body.removeChild(_),t[k](r,i),t[k](q,d),G.pause(),e=0),V[T]=V[T]||0,[17,18,27,37,38,39,40,77].indexOf(T)>=0&&o.preventDefault()})),t[i](q,d)}())}))}()