<title>1½ KB Tetris</title><style>table{border:4px groove #6b0;font-size:9}td{width:1em;border:solid #fff}pre{margin:9;float:left}</style><body onkeydown=k(event)><pre id=s></pre><table cellspacing=0 id=t></table><script>var Y,t,d=document,W=10,H=25,s=l=0;function a(){for(r=B.insertRow(0),x=W;x--;)r.insertCell(0).appendChild(d.createTextNode(" "))}function T(e,n,t){for(i=4;i--;)q="defgaeimdefgaeimdefjaeibdhijibfjdhefaeijhifjabfjeifjeifjeifjeifjheifaefjheifaefjdeifaeifheijebfjdeijeibfdeijeibf".charCodeAt(16*e+4*n+i)-96,t(q%4,q>>2)}function D(t,r,f,e){T(f,e,function(e,n){p=" #"+(t?"0ff00f808".substr(f,3):"fff"),v=S[r+n].cells[X+e],o=v.style,o.background=p,o.border=(t?"outset":"solid")+p,v.s=t})}function M(t,f,e){return D(0,Y,b,r),c=4,T(b,e,function(e,n){e+=X+t,n+=Y+f,(e<0||W<=e||H<=n||S[n].cells[e].s)&&(c=0)}),c&&(X+=t,Y+=f,r=e),D(1,Y,b,r),c}function C(){for(X=3,D(0,-1,n,0),p=0,y=Y;y<H;y++){for(f=0,x=W;x--;)f|=!S[y].cells[x].s;f||(B.deleteRow(y),a(),p++)}d.getElementById("s").innerHTML="Score: "+(s+=9<<p)+"\nLines: "+(l+=p)+"\n\n© MMIV Joris Zwart",clearInterval(t),t=setInterval(F,650-l),b=n,n=new Date%7,D(1,-1,n,0),Y=1,M(r=0,1,r)||(clearInterval(t),alert(":-("))}function F(){M(0,1,r)||C()}function k(e){switch(e.which||event.keyCode){case 74:case 37:M(-1,0,r);break;case 75:case 38:M(0,0,(r+1)%4);break;case 76:case 39:M(1,0,r);break;case 32:clearInterval(t),t=setInterval(F,9);case 73:case 40:case 77:F()}}for(B=d.getElementById("t"),n=new Date%7,S=B.rows,y=H;y--;)a();C()</script>